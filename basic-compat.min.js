/**
* minimal jquery/zepto compatibility layer
* be aware that won't mimic jquery/zepto at all but offer a similar api for basic stuffs as querySelectorAll and addEventListener ...
* @author jgotti at modedemploi dot fr for agence-modedemploi.com
* @licence Dual licence LGPL / MIT
* @changelog
*            - 2013-01-29 - big correction in not
*            - 2013-01-23 - add scoping to selectors to react more like jquery
*                         - better performance in selectors
*            - 2013-01-21 - add removeAttr and support for plainObject and function as value for attr method
*                         - bug correction in extend regarding arrays properties
*            - 2013-01-18 - add isArray/isFunction/isNumeric/isObject/isEmptyObject/isPlainObject/filter/not methods
*                         - is/filter/not may now use selector, domElement, function or collection to match against
*                         - first attempt for adding selectors and namespaces supports to on and off methods
*            - 2012-12-11 - add hasClass/addClass/removeClass/toggleClass/hide/show/toggle/is/closest methods
*            - 2012-12-07 - add css/attr/prop/html/remove/find methods
*            - 2012-11-28 - more jquery like syntax and some events related stuffs
*/(function(e){"use strict";if(!e){e=function(t,n){if(E(t))return e.ready(t);var r;if(t===window||t===document||C(t))r=[t];else if(b(t))r=t;else if(!b(n))if((!n||n.nodeType===9)&&L.test(t))r=[(n||document).getElementById(t.substr(1))];else if(k.test(t))r=O((n||document).getElementsByClassName(t.substr(1)));else if(A.test(t))r=O((n||document).getElementsByTagName(t));else{n&&(n===window||n.document)&&(n=n.document);var i="";n&&t.match(/(^\s*[:>]|\S\s+\S)/)&&(i="#"+(n.id||(n.id=o))+" "),r=O((n||document).querySelectorAll(i+t)),i&&n.id===o&&(n.id=null)}else r=[],e.each(n,function(n,i){e(t,i).each(function(e,t){r.push(t)})});return r.hasOwnProperty("each")||e.each(e.fn,function(e,t){r[e]=t}),r},e.ready=function(e){return document.readyState.match(/complete|loaded|interactive/)?setTimeout(e,0):document.addEventListener("DOMContentLoaded",function(){setTimeout(e,0)},!1),this},e.extend=function(){var t=arguments,r=typeof t[0]=="boolean"?!0:!1,i=r?t[0]:!1,s=t[r?1:0],o=r?2:1,u=t.length,a;o===2&&(s=t[1]);for(;o<u;o++){if(t[o]==null)continue;for(a in t[o]){if(t[o][a]===n||t[o][a]===s||!t[o].hasOwnProperty(a))continue;i&&typeof t[o][a]=="object"?(s[a]=s[a]||(b(t[o][a])?[]:{}),e.extend(i,s[a],t[o][a])):s[a]=t[o][a]}}return s},e.each=function(e,t){var n,r,i;if(b(e)||e instanceof NodeList){for(n=0,r=e.length;n<r;n++)if(t.call(e[n],n,e[n])===!1)return e}else for(i in e)if(e.hasOwnProperty(i)&&t.call(e[i],i,e[i])===!1)return e;return e},e.Event=function(t,n){var r=document.createEvent(t.match(/^(click|mousedown|mouseup|mousemove)$/)?"MouseEvents":"Events");return n&&e.extend(r,n),r.initEvent(t,n&&n.bubbles===!1?!1:!0,!0,null,null,null,null,null,null,null,null,null,null,null,null),r};var t={},n,r={elmts:{},handlers:{}},i=0,s=function(e){return e._uid||(e._uid=++i)},o="bcScopeSelectorId",u=window.document.addEventListener?function(e,t,n){t.addEventListener(e,n,!1)}:function(e,t,n){t.attachEvent("on"+e,n)},a=window.document.removeEventListener?function(e,t,n){t.removeEventListener(e,n,!1)}:function(e,t,n){t.detachEvent("on"+e,n)},f=function(t,i,o,a){e.each(t.split(/\s+/),function(e,t){var f=t.split("."),l=s(o);r.handlers[l]=o,(r.elmts[s(i)]||(r.elmts[s(i)]=[])).push({ns:f.length<2?n:f.slice(1).sort().join(" "),type:f[0],handler:l,s:a||n}),u(f[0],i,o)})},l=function(t,i,o,u){e.each(t.split(/\s+/),function(t,f){var l=f.split("."),c=o?s(o):n,h=l.slice(2).sort().join(" ");f=l[0];if(!r.elmts[s(i)])return;for(var p=s(i),d=r.elmts[p].length,v,m;~--d;)v=r.elmts[p][d],(!f||v.type===f)&&(!u||v.s===u)&&(!c||v.handler===c)&&(!h||v.ns&&v.ns.match(new RegExp("(^| )"+h+"( |$)")))&&(a(v.type,i,r.handlers[v.handler])||r.elmts[p].splice(d,1)),m=!0,e.each(r.elmts,function(t,n){return e.each(n,function(e,t){if(t.handler===v.handler)return m=!1}),m}),m&&delete r.handlers[v.handler]})},c=function(){return!0},h=function(){return!1},p=function(e,t){return"className"in e&&e.className.match(new RegExp("(^|\\s)"+t+"($|\\s)"))?!0:!1},d=function(e,t){return window.getComputedStyle&&window.getComputedStyle(e,null).getPropertyValue(t)},v=function(t,n){var r=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;return r?r.call(t,n):!!~e(n,t.parentNode).indexOf(t)},m=function(e,t,n){return t.call(e,n)},g=function(e,t){return!!~t.indexOf(e)},y=function(e){var t=typeof e;return t==="string"?v:t==="function"?m:g},b=e.isArray=function(e){return e instanceof Array},w=e.isObject=function(e){return typeof e=="object"},E=e.isFunction=function(e){return e instanceof Function},S=e.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},x=e.isEmptyObject=function(t){var n=!0;return e.each(t,function(){return n=!1}),n},T=e.isPlainObject=function(e){if(!(e instanceof Object)||e.nodeType||e.window&&e.window===e)return!1;try{if(e.constructor.prototype.hasOwnProperty("isPrototypeOf"))return!0}catch(t){}return!1},N=e.isDomNode=function(e){return w(e)&&e.nodeType},C=e.isDomElmt=function(e){return N(e)&&e.nodeType===1},k=/^\s*\.([a-z0-9-]+)\s*$/i,L=/^\s*#([a-z0-9-]+)\s*$/i,A=/^\s*([a-z]+)\s*$/i,O=function(e){return[].slice.call(e,0)};e.fn={each:function(t){return e.each(this,t),this},on:function(t,r,i,s){var o=arguments,u=o.length,a;return s||(s=o[u-1]),u===2?r=i=n:u===3&&(w(r)?(i=r,i=n):i=n),a=r||i?function(t){if(r===n||e(t.target).is(r))return i&&(t.data=i),s.call(t.target,t)}:s,e.each(this,function(e,n){f(t,n,a,r)})},off:function(t,r,i){return!i&&E(r)&&(i=r,r=n),e.each(this,function(e,n){l(t,n,i,r)})},trigger:function(t,n){return typeof t=="string"&&(t=e.Event(t)),n&&(t.data=n),e.each(this,function(e,n){"dispatchEvent"in n&&n.dispatchEvent(t)})},css:function(t,r){if(w(t)){var i=this;return e.each(t,function(e,t){i.css(e,t)}),this}t.match(/[A-Z]/)&&(t=t.replace(/([A-Z])/g,"-$1"));var s=t.replace(/-([a-z])/g,function(e,t){return t.toUpperCase()});return r===n?this[0].style[s]||d(this[0],t):e.each(this,function(e,t){t.style[s]=r})},attr:function(t,r){if(T(t)){var i=this;return e.each(t,function(e,t){i.attr(e,t)}),this}if(r===n){var s=this[0].getAttribute(t);return!s&&t in this[0]?this[0][t]:s}return e.each(this,function(e,n){E(r)?t in n?n[t]=r.call(n,e,n[t]):n.setAttribute(t,r.call(n,e,n.getAttribute(t))):t in n?n[t]=r:r?n.setAttribute(t,r):n.removeAttribute(t)})},removeAttr:function(e){return this.attr(e,"")},prop:function(t,r){return r!==n?this[0]&&this[0][t]:e.each(this,function(e,n){n[t]=r})},html:function(t){return t===n?this[0][C(this[0])?"innerHTML":"value"]:e.each(this,function(e,n){n[C(n)?"innerHTML":"value"]=t})},remove:function(){return e.each(this,function(){this.parentNode&&this.parentNode.removeChild(this)})},find:function(t){var n=[];return e(t,this).each(function(){n.push(this)}),e(n)},hasClass:function(t){var n=!1;return e.each(this,function(){if(p(this,t))return!(n=!0)}),n},addClass:function(t){return t=t.split(/\s+/),e.each(this,function(n,r){e.each(t,function(){p(r,this)||(r.className+=(r.className.length?" ":"")+this)})})},removeClass:function(t){var n=new RegExp("(^|\\s)("+t.replace(/\s+/g,"|")+")($|\\s)","g"),r=function(e,t,n,r){return t===r?" ":""};return e.each(this,function(){this.className=this.className.replace(n,r)})},toggleClass:function(t,r){return r=r===n?p:r?c:h,t=t.split(/\s+/),e.each(this,function(n,i){e.each(t,function(){e(i)[r(i,this)?"addClass":"removeClass"](this)})})},hide:function(){return e.each(this,function(){var t=e(this),n=t.css("display");if(n==="none")return;this.setAttribute("data-bc-oldisplay",n),t.css("display","none")})},show:function(){return e.each(this,function(){this.style.display=null,d(this,"display")==="none"&&(this.style.display=this.getAttribute("data-bc-olddisplay")||function(e){if(!t[e.nodeName]){var n=document.createElement(e.nodeName),r=document.body;r.appendChild(n),t[e.nodeName]=d(n,"display"),t[e.nodeName]==="none"&&(t[e.nodeName]="block"),r.removeChild(n)}return t[e.nodeName]}(this))})},toggle:function(t){return t=t===n?function(e){return e.css("display")==="none"}:t?c:h,e.each(this,function(){var n=e(this);n[t(n)?"show":"hide"]()})},is:function(t){if(N(t))return!!~this.indexOf(t);var n=!1,r=y(t);return e.each(this,function(e,i){if(r(i,t,e))return!(n=!0)}),n},filter:function(t){if(N(t))return e(~this.indexOf(t)?t:[]);var n=[],r=y(t);return e.each(this,function(e,i){r(i,t,e)&&n.push(i)}),e(n)},not:function(t){if(N(t))return e(~this.indexOf(t)?[]:t);var n=[],r=y(t);return e.each(this,function(e,i){r(i,t,e)||n.push(i)}),e(n)},closest:function(t){var n=[];return e.each(this,function(r,i){do if(e(i).is(t))return!n.push(i);while(i=i.parentNode)}),e(n)}},window.$=e}})(typeof $!="undefined"?$:!1);